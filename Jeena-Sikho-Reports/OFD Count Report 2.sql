SELECT\ndate(cl.callstart_date) as Date,\nif(hour(cl.callstart_date) = 6 and hour(cl.callend_date) = 7, '06:00 To 07:00', \nif(hour(cl.callstart_date) = 7 and hour(cl.callend_date) = 8, '07:00 To 08:00', \nif(hour(cl.callstart_date) = 8 and hour(cl.callend_date) = 9, '08:00 To 09:00', \nif(hour(cl.callstart_date) = 9 and hour(cl.callend_date) = 10, '09:00 To 10:00', \nif(hour(cl.callstart_date) = 10 and hour(cl.callend_date) = 11, '10:00 To 11:00', \nif(hour(cl.callstart_date) = 11 and hour(cl.callend_date) = 12, '11:00 To 12:00',\nif(hour(cl.callstart_date) = 12 and hour(cl.callend_date) = 13, '12:00 To 13:00',\nif(hour(cl.callstart_date) = 13 and hour(cl.callend_date) = 14, '13:00 To 14:00',\nif(hour(cl.callstart_date) = 14 and hour(cl.callend_date) = 15, '14:00 To 15:00', \nif(hour(cl.callstart_date) = 15 and hour(cl.callend_date) = 16, '15:00 To 16:00',\nif(hour(cl.callstart_date) = 16 and hour(cl.callend_date) = 17, '16:00 To 17:00',\nif(hour(cl.callstart_date) = 17 and hour(cl.callend_date) = 18, '17:00 To 18:00',\nif(hour(cl.callstart_date) = 18 and hour(cl.callend_date) = 19, '18:00 To 19:00', \nif(hour(cl.callstart_date) = 19 and hour(cl.callend_date) = 20, '19:00 To 20:00', \nif(hour(cl.callstart_date) = 20 and hour(cl.callend_date) = 21, '20:00 To 21:00',\nif(hour(cl.callstart_date) = 21 and hour(cl.callend_date) = 22, '21:00 To 22:00', \nif(hour(cl.callstart_date) = 22 and hour(cl.callend_date) = 23, '22:00 To 23:00',\nif(hour(cl.callstart_date) = 23 and hour(cl.callend_date) = 24, '23:00 To 24:00',''\n)))))))))))))))))) as 'Hourly_Track',\nLd.channel as channel,\n\nCOUNT(CASE WHEN cl.disposition = 'Offered call' THEN 1 END) AS 'Offered_Call :400',\nCOUNT(CASE WHEN cl.disposition = 'Answered' THEN 1 END) AS 'Answered_Call :400',\nCOUNT(CASE WHEN cl.disposition = 'Abandon call' THEN 1 END) AS 'Abandon_call :400'\nfrom (select callstart_date,callend_date,creation,lead, from `tabCall Log`) cl, (select channel,name from `tabLead`) Ld\nwhere cl.lead = Ld.name  and cl.creation NOT BETWEEN NOW() AND (NOW() - INTERVAL 1 HOUR) and date(cl.callstart_date) between %(from_date)s and %(to_date)s\ngroup by Hourly_Track\norder by date\n/* add date filter on call log creation field*/